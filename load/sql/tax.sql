# load data
drop table original.tax;
create table original.tax(
	parcel_id character varying(10),
	cm_id character varying(10),
	owner character varying(100),
	st_num character varying(10),
	st_name character varying(100),
	st_name_suf character varying(100),
	unit_num character varying(20),
	zipcode character varying(10),
	ptype integer,
	lotsize integer,
	mail_address character varying(100),
	mail__cs character varying(100),
	mail_zip character varying(10),
	gross_area numeric,
	bldg_area numeric,
	av_land numeric,
	av_bldg numeric,
	gross_tax numeric,
	num_floors numeric,
	fy2000_lu character varying(10),
	fy2000_av numeric,
	fy2000_resex character varying(10),
	fy2001_lu character varying(10),
	fy2001_av numeric,
	fy2001_resex character varying(10),
	fy2002_lu character varying(10),
	fy2002_av numeric,
	fy2002_resex character varying(10),
	fy2003_lu character varying(10),
	fy2003_av numeric,
	fy2003_resex character varying(10),
	fy2004_lu character varying(10),
	fy2004_av numeric,
	fy2004_resex character varying(10),
	fy2005_lu character varying(10),
	fy2005_av numeric,
	fy2005_resex character varying(10),
	fy2006_lu character varying(10),
	fy2006_av numeric,
	fy2006_resex character varying(10),
	fy2007_lu character varying(10),
	fy2007_av numeric,
	fy2007_resex character varying(10),
	fy2008_lu character varying(10),
	fy2008_av numeric,
	fy2008_resex character varying(10),
	fy2009_lu character varying(10),
	fy2009_av numeric,
	fy2009_resex character varying(10),
	fy2010_lu character varying(10),
	fy2010_av numeric,
	fy2010_resex character varying(10),
	fy2011_lu character varying(10),
	fy2011_av numeric,
	fy2011_resex character varying(10),
	fy2012_lu character varying(10),
	fy2012_av numeric,
	fy2012_resex character varying(10),
	fy2013_lu character varying(10),
	fy2013_av numeric,
	fy2013_resex character varying(10),
	x numeric,
	y numeric,
	ref_id numeric,
	blk_id numeric,
	bg_id numeric,
	ct_id numeric,
	locationid numeric,
	nsa_name character varying(100),
	nbhd character varying(100),
	blk_id_10 numeric,
	bg_id_10 numeric,
	ct_id_10 numeric
);

-- load data
\COPY original.tax FROM '/Volumes/SaoirseMor/Dropbox/dataswap/TaxAssessorDatabase/TaxAssessorDatabase.csv' WITH CSV HEADER DELIMITER AS ',';

-- make geom / index
SELECT AddGeometryColumn('original', 'tax', 'geom', 26986, 'POINT', 2);
UPDATE original.tax set geom = ST_SetSRID(ST_MakePoint(x, y), 26986);
CREATE INDEX idx_tax ON original.tax USING GIST ( geom );
